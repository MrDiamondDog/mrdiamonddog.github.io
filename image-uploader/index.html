<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Uploader</title>
    <link rel="stylesheet" href="../main.css">
    <style>
        .uploadcare--widget__text{
            display: none !important;
        }
        #upload-button{
            display: block !important;
        }
    </style>
    <script>
        UPLOADCARE_PUBLIC_KEY = '76ef5257a3d5f416089e';
    </script>
    <script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.full.min.js"></script>
</head>
<body>
    <h1>Image Uploader</h1>
    <input type="hidden" role="uploadcare-uploader" name="my_file_input" data-system-dialog="true"/>

    <script>
        document.addEventListener("DOMContentLoaded", async function(){
            await sleep(5);
            document.getElementsByClassName("uploadcare--widget__button")[0].id = "upload-button";
            var file = document.getElementsByName("my_file_input")[0].value;
            var a = document.createElement("a");
            a.target = "_blank";
            document.body.appendChild(document.createElement("br"));
            document.body.appendChild(a);
            setTimeout(function(){
                console.log(file);
                if (file == "") return;
                a.href = file;
                a.innerHTML = a.href;
                file = "";
            }, 1000);
        })

        function sleep(ms){
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>